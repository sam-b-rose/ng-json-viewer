/*! jv.json-viewer v0.2.0 | Sam Rose <samrose3@gmail.com> | (c) 2015 */
angular.module("jv.json-viewer",[]),function(){"use strict";function t(){function t(){function t(){function t(){document.querySelector("#main").classList.toggle(this.id)}var e,n=0,s=document.querySelectorAll(".ui-option");for(n=0;n<s.length;n++)e=s[n],e.addEventListener(r,t,!1);i.addEventListener(r,function(t){(t.target.classList.contains("toggle")||t.target.classList.contains("toggle-end"))&&t.target.parentNode.classList.toggle("collapsed")},!1)}function n(t){function e(t){return s(n(t))}function n(t){return t.replace(/\s+$/g,"")}function s(t){return t.replace(/^\s+/g,"")}function i(){for(var t,e,n=0;;){for(n=p.indexOf('"',n+1),t=0,e=1;;){if("\\"!==p.substring(n-e,n-e+1))break;t+=1,e++}if(t%2===0)break}return n}function r(t){function e(t){function n(t){var e,n,s,r=t.substring(0,1);if(t.update(""),'"'===r){if(e=t.shift(i(t.todo)+1),-1!==e.search(/\\u(?![\d|A-F|a-f]{4})/g))return t.err("\\u must be followed by 4 hexadecimal characters",e);for(n=e.length,s=0;n>s;s++)if("\\"===e.substring(s,s+1)&&n>s+1&&(s++,!e.substring(s,s+1).search(/[^\"|\\|\/|b|f|n|r|t|u]/)))return t.err("Backslash must be escaped",e);return t.update('<span class="property">"<span class="p">'+e.substring(1,e.length-1)+'</span>"</span>')}return e=t.shift(t.indexOf(":")),t.err("Name property must be a String wrapped in double quotes.",e)}function s(t){return":"!==t.substring(0,1)&&t.err("Semi-column is missing.",t.shift(t.indexOf(":"))),t.swap(1)}return t.update("<li>"),"}"===t.substring(0,1)?t.update("</li>"):(t=n(t),t=s(t),t=o(t,"}"),","===t.substring(0,1)?(t.swap(1).update("</li>"),e(t)):"}"===t.substring(0,1)?t.update("</li>"):t.err("Comma is missing",t.shift(t.indexOf("}"))).update("</li>"))}return-1===t.indexOf("{")?(t.err("Opening brace is missing",t.todo),t.update("","")):(t.shift(1),t.update('<span class="object"><span class="toggle">{</span><ul>'),t=e(t).update("</ul>"),-1===t.indexOf("}")?(t.err("Closing brace is missing",t.todo),t.update("","")):t.span("toggle-end",t.shift(1)))}function u(t){function e(t){return t.update("<li>"),t=o(t,"]"),","===t.substring(0,1)?(t.swap(1).update("</li>"),e(t,++n)):"]"===t.substring(0,1)?t.update("</li>"):t.err("Comma is missing",t.shift(t.search(/(,|\])/))).update("</li>")}var n=0;return-1===t.indexOf("[")?(t.err("Opening square bracket is missing",t.todo),t.update("","")):(t.shift(1),t.update('<span class="array">'),t.update('<span class="toggle">[</span><ol>'),0===t.indexOf("]")?(t.shift(1),t.update('</ol><span class="toggle-end" card="0">]</span>'),t.update("</span>")):(t=e(t,0),-1===t.indexOf("]")?(t.err("Closing square bracket is missing",t.todo),t.update('</ol><span class="toggle-end" card="'+(n+1)+'"></span>'),t.update("</span>")):(t.shift(1),t.update('</ol><span class="toggle-end" card="'+(n+1)+'">]</span>'),t.update("</span>"))))}function o(t,e){var s,o,d,l,c,p="";if(0===t.search(/^(")/)){if(s=t.shift(i(t.todo)+1),-1!==s.search(/\\u(?![\d|A-F|a-f]{4})/g))return t.err("\\u must be followed by 4 hexadecimal characters",s);for(l=s.length,d=0;l>d;d++)if("\\"===s.substring(d,d+1)&&l>d+1&&(d++,!s.substring(d,d+1).search(/[^\"|\\|\/|b|f|n|r|t|u]/)))return t.err("Backslash must be escaped",s);return t.span("string",s)}if(0===t.search(/^\{/))return r(t);if(0===t.search(/^\[/))return u(t);o=t.search(new RegExp("(,|"+e+")")),-1===o?(o=t.todo.length-1,c=n(t.todo),t.update("","")):c=n(t.shift(o));try{p=a(c)}catch(g){}switch(p){case"boolean":case"number":return t.span(p,c);default:return"null"===c?t.span("null",c):0===c.search(/^(')/)?t.err("String must be wrapped in double quotes",c):t.err("Unknown type",c)}}var d,l=!1,c=function(t){this.done="",this.todo=t?t:"",this.update=function(t,e){return t&&(this.done+=t),void 0!==e&&(this.todo=s(e)),this},this.swap=function(t){return t&&!isNaN(Number(t))&&this.todo.length>=t&&this.update(this.todo.substr(0,t),this.todo.substring(t)),this},this.toString=function(){return 0!==this.todo.length&&this.err("Text after last closing brace.",this.todo),this.done},this.span=function(t,e){return this.update('<span class="'+t+'">'+e+"</span>")},this.err=function(t,e){return l=!0,this.update('<span class="error" title="'+t+'">'+e+"</span>")},this.shift=function(t){var e;return t&&!isNaN(Number(t))&&this.todo.length>=t?(e=this.substring(0,t),this.update("",this.substring(t)),n(e)):""},this.indexOf=function(t,e){return e?this.todo.indexOf(t,e):this.todo.indexOf(t)},this.substring=function(t,e){return e?this.todo.substring(t,e):this.todo.substring(t)},this.search=function(t){return this.todo.search(t)}},p=new c(e(t));return d="["===s(t).substr(0,1)?{html:u(p).toString(),valid:!l}:"{"===s(t).substr(0,1)?{html:r(p).toString(),valid:!l}:{html:p.err("JSON expression must be an object or an array",t).update(null,"").toString(),valid:!1},console.log(d),d}function s(s){function r(t){var e="[\\x20\\t\\r\\n\\f]",n=new RegExp("^"+e+"+|((?:^|[^\\\\])(?:\\\\.)*)"+e+"+$","g");return t.replace(n,"")}if(""===r(s))return void(i.innerHTML="");s=s.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;");var a=n(s);i.innerHTML=a.html,e.handlersCreated||(t(),e.handlersCreated=!0)}var i=document.getElementById("result"),r="click",a=function(t){return typeof JSON.parse(t)};return s(e.jsonString)}var e={jsonString:"",handlersCreated:!1,parseJson:t};return e}angular.module("jv.json-viewer").service("jsonViewerService",t)}(),function(){"use strict";function t(t,e){function n(t){t.analyzeJson=function(){t.editor?e.jsonString=t.editorText:t.data&&(angular.isString(t.data)?(t.editorText=t.data,e.jsonString=t.data):(t.editorText=angular.toJson(t.data,!1),e.jsonString=angular.toJson(t.data,!1))),e.parseJson()}}var s={restrict:"E",template:t.get("jsonViewer/jsonViewer.tpl.html"),scope:{editor:"=",data:"="},link:n};return s}angular.module("jv.json-viewer").directive("jvJsonViewer",t),t.$inject=["$templateCache","jsonViewerService"]}(),angular.module("jv.json-viewer").run(["$templateCache",function(t){t.put("jsonViewer/jsonViewer.tpl.html",'<div id="main" class="beautify">\n  <div class="ui-editor" ng-show="editor">\n    <textarea class="ui-field json" id="editor" ng-model="editorText" ng-change="analyzeJson()" spellcheck="false" contenteditable="true"></textarea>\n    <div class="ui-resizer"></div>\n  </div>\n  <div class="ui-aside">\n    <div class="ui-notification" id="status"><b>Invalid JSON</b> &nbsp; 1&nbsp;error&nbsp;found</div>\n    <div class="ui-menu">\n      <div class="ui-menu-dropdown">\n        <div class="ui-menu-panel">\n          <div class="ui-menu-item ui-option" id="beautify">Beautify</div>\n          <div class="ui-menu-item ui-option" id="show-types">Show Types</div>\n          <div class="ui-menu-item ui-option" id="show-indexes">Show Indexes</div>\n          <div class="ui-menu-item about" style="display:none">About</div>\n        </div>\n      </div>\n    </div>\n    <div class="ui-treeview json" id="result">\n    </div>\n  </div>\n</div>\n')}]);